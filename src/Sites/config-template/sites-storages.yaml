---
domains:
  access-point: sites
  module: Sites
  models:
    row: Models\Domain
    table: Models\Domains
  desc: Сайты
  params:
    visible: false
    maybepublished: false
  fields:
    name:
      type: varchar
      length: 255
      class: string
      desc: Наименование сайта
      note: Введите наименование сайта
      params:
        required: true
        readonly: false
    description:
      type: varchar
      length: 255
      class: string
      desc: Описание страницы
      note: Введите описание сайта
      params:
        required: true
        readonly: false
    closed:
      type: tinyint
      length: 1
      class: bool
      desc: Закрыт
      note: Выберите «Да» если хотите закрыть сайт
      component: Radio
      params:
        required: true
        readonly: false
      default: "0"
      selector:
        value: value
        title: title
      values:
      - value: "0"
        title: Нет
      - value: "1"
        title: Да
    domains:
      type: json
      class: ArrayField
      component: Array
      desc: Список доменов
      note: Можно использовать регулярные выражения
      default: "json_array()"
      params:
        addlink: Добавить домен
      fields:
        pattern: 
          type: varchar
          length: 255
          class: string
          component: Text 
    additional:
      type: json
      class: ObjectField
      component: Tabs
      desc: Дополнительные параметры
      default: json_object()
      fields:
        settings:
          type: json
          class: ObjectField
          component: Object
          desc: Технические данные
          params:
            vertical: true
          default: json_object()
          fields:
            type: 
              type: enum
              class: ValueField
              component: Select
              default: 'application'
              values:
                - value: application
                  title: Приложение
                - value: website
                  title: Обычный вебсайт
            module: 
              type: varchar
              length: 255
              class: string
              component: Select
              desc: Стартовый модуль
              note: Выжерите модуль, который будет стартовать
              default: 
              selector:
                value: value
                title: title
              lookup:
                method: '
                  () => new Promise((resolve, reject) => { 
                    let ret = [{value: "", title: "Шаблон не выбран"}]; 
                    Object.keys(App.Modules).forEach((module) => { 
                      ret.push({value: module, title: module}); 
                    }); 
                    resolve(ret); 
                  });'
        parameters:
          type: json
          class: ArrayField
          component: Array
          desc: Дополнительные свойства
          default: json_array()
          attrs:
            className: app-field-wrap
          params:
            addlink: Добавить параметр
          fields:
            name:
              type: varchar
              length: 50
              class: string
              component: Text
              desc: Наименование поля
              attrs:
                width: 30%
            description:
              type: varchar
              length: 255
              class: string
              component: Text
              desc: Описание поля
              attrs:
                width: 68%
            type:
              type: enum
              length: 255
              desc: Тип
              component: Select
              default: text
              attrs:
                width: 15%
              values:
              - value: text
                title: Текст
              - value: integer
                title: Целое число
              - value: double
                title: Число с плавающей запятой
              - value: object
                title: Обьект
              - value: array
                title: Массив
            default:
              type: varchar
              length: 255
              class: string
              component: Text
              desc: Значение по умолчанию
              attrs:
                width: 30%
            class:
              type: varchar
              length: 255
              class: string
              component: Text
              desc: Класс (PHP)
              attrs:
                width: 30%
            component:
              type: varchar
              length: 255
              class: string
              default: Text
              component: Select
              desc: Компонента (JS)
              selector:
                value: value
                title: title
              lookup:
                method: '
                  () => new Promise((resolve, reject) => {
                    let ret = []; 
                    Object.forEach(Colibri.UI.Forms.Field.Components, (name, value) => { 
                      ret.push({value: name, title: value.description});
                    }); 
                    resolve(ret);
                  })'
              attrs:
                width: 22%
  indices:
pages:
  access-point: sites
  module: Sites
  models:
    row: Models\Page
    table: Models\Pages
  desc: Страницы
  params:
    visible: false
    maybepublished: false
  fields:
    parent:
      type: bigint unsigned
      class: App\Modules\Sites\Models\Page
      component: Hidden
      desc: Отцовская страница
      default: "0"
      params:
        required: true
        readonly: false
      lookup:
        storage:
          name: pages
          title: description
          value: id
    name:
      type: varchar
      length: 255
      class: string
      desc: Наименование раздела
      note: Введите наименование страницы, наименование будет использовано в URL
      params:
        required: true
        readonly: false
    description:
      type: varchar
      length: 255
      class: string
      desc: Описание страницы
      note: Введите описание сайта
      params:
        required: true
        readonly: false
    published:
      type: tinyint
      length: 1
      class: bool
      desc: Опубликована
      note: Выберите «Да» если хотите опубликовать сайт
      component: Radio
      params:
        required: true
        readonly: false
      default: "0"
      selector:
        value: value
        title: title
      values:
      - value: "0"
        title: Нет
      - value: "1"
        title: Да
    additional:
      type: json
      class: ObjectField
      component: Tabs
      desc: Всякое
      default: json_object()
      fields:
        meta:
          type: json
          class: ObjectField
          desc: Мета данные
          component: Object
          params:
            vertical: true
          default: json_object()
          fields:
            title:
              type: varchar
              length: 512
              class: string
              component: Text
              desc: Заголовок страницы
              note: Введите заголовок страницы
            description:
              type: varchar
              length: 1024
              class: string
              component: TextArea
              description: Описание сайта
              note: Введите мета описание сайта
            keywords:
              type: varchar
              length: 1024
              class: string
              component: TextArea
              description: Ключевые слова
              note: Введите ключевые слова
        settings:
          type: json
          class: ObjectField
          component: Object
          desc: Технические данные
          params:
            vertical: true
          default: json_object()
          fields:
            template:
              type: varchar
              length: 255
              class: string
              component: Select
              desc: Шаблон
              note: Введите описание сайта
              default: ''
              selector:
                value: value
                title: title
              lookup:
                method: '
                  () => new Promise((resolve, reject) => { 
                      let ret = [{value: "", title: "Шаблон не выбран"}]; 
                      Object.keys(App.Modules).forEach((module) => { 
                        Object.forEach(eval(''App.Modules.'' + module), (name, value) => { 
                          if(name.indexOf(''Page'') !== -1) { 
                            ret.push({value: name, title: module + ''.'' + name}); 
                          } 
                        }); 
                      }); 
                      resolve(ret); 
                    }); 
                  '
            parameters:
              type: json
              class: ArrayField
              component: Array
              desc: Дополнительные свойства
              default: json_array()
              attrs:
                className: app-field-wrap
              params:
                addlink: Добавить параметр
              fields:
                name:
                  type: varchar
                  length: 50
                  class: string
                  component: Text
                  desc: Наименование поля
                  attrs:
                    width: 30%
                description:
                  type: varchar
                  length: 255
                  class: string
                  component: Text
                  desc: Описание поля
                  attrs:
                    width: 68%
                type:
                  type: enum
                  length: 255
                  desc: Тип
                  component: Select
                  default: text
                  attrs:
                    width: 15%
                  values:
                  - value: text
                    title: Текст
                  - value: integer
                    title: Целое число
                  - value: double
                    title: Число с плавающей запятой
                  - value: object
                    title: Обьект
                  - value: array
                    title: Массив
                default:
                  type: varchar
                  length: 255
                  class: string
                  component: Text
                  desc: Значение по умолчанию
                  attrs:
                    width: 30%
                class:
                  type: varchar
                  length: 255
                  class: string
                  component: Text
                  desc: Класс (PHP)
                  attrs:
                    width: 30%
                component:
                  type: varchar
                  length: 255
                  class: string
                  default: Text
                  component: Select
                  desc: Компонента (JS)
                  selector:
                    value: value
                    title: title
                  lookup:
                    method: '
                      () => new Promise((resolve, reject) => {
                        let ret = []; 
                        Object.forEach(Colibri.UI.Forms.Field.Components, (name, value) => { 
                          ret.push({value: name, title: value.description});
                        }); 
                        resolve(ret);
                      })'
                  attrs:
                    width: 22%
    order:
      type: int
      class: int
      default: "0"
      component: Hidden
      desc: Позиция в рамках parent-а
  indices:
    pages_parent_idx:
      fields:
      - parent
      type: NORMAL
      method: BTREE
    pages_name_idx:
      fields:
      - name
      type: NORMAL
      method: BTREE
    pages_order_idx:
      fields:
      - order
      type: NORMAL
      method: BTREE
    pages_published_idx:
      fields:
      - published
      type: NORMAL
      method: BTREE
pubs:
  access-point: sites
  module: Sites
  models:
    row: Models\Publication
    table: Models\Publications
  desc: Публикации
  params:
    visible: false
    maybepublished: false
  fields:
    page:
      type: bigint unsigned
      class: App\Modules\Sites\Models\Page
      desc: Страница
      note: Выберите страницу
      params:
        required: true
        readonly: false
      lookup:
        storage:
          name: pages
          title: description
          value: id
    storage:
      type: varchar
      length: 255
      class: string
      desc: Хранилище материалов
      note: Выберите хранилище материалов
      params:
        required: true
        readonly: false
    row:
      type: bigint unsigned
      class: int
      desc: ID записи в хранилище
      note: Введите ID записи в хранилище
      params:
        required: true
        readonly: false
    ft:
      type: longtext
      class: string
      params:
        required: false
        readonly: false
      desc: Полнотекстовый поиск
    object:
      type: json
      class: ObjectField
      desc: Данные строки
      default: json_object()
    order:
      type: int
      class: int
      default: 0
      desc: Позиция в рамках страницы
  indices:
    pubs_pagestoragerow_idx:
      fields:
      - page
      - storage
      - row
      type: NORMAL
      method: BTREE
    pubs_order_idx:
      fields:
      - order
      type: NORMAL
      method: BTREE
    pubs_ft_idx:
      fields:
      - ft
      type: FULLTEXT
      method: ~
texts:
  access-point: sites
  module: Sites
  models:
    row: Models\Text
    table: Models\Texts
  desc: Текстовые данные
  params:
    visible: true
    maybepublished: true
  fields:
    title:
      type: varchar
      length: 255
      class: string
      component: Text
      desc: Заголовок
      note: Введите заголовок текстового блока, если необходимо
      params:
        required: false
        readonly: false
        enabled: true
        list: true
    html:
      type: longtext
      class: string
      desc: Содержание
      note: Введите содержание
      component: App.Modules.Manage.UI.TinyMCETextArea
      params:
        required: true
        readonly: false
        enabled: true
        visual: true
        list: true
    file:
      type: json
      class: ObjectField
      component: App.Modules.Manage.UI.RemoteFiles
      desc: Тестовый файл
      default: "json_object()"
      params:
        required: false
        enabled: true
        readonly: false
        visual: false
        list: false
        vertical: false
      group: window
  indices:
    texts_title_idx:
      fields:
      - title
      type: NORMAL
      method: BREE
...
